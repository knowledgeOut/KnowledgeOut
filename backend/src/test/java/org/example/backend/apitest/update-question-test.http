### 0. 사전 준비 (카테고리 데이터가 없다면 먼저 실행)
# DataInitializer가 있다면 생략 가능하지만, 확실히 하기 위해 카테고리가 1번(기술)이 존재하는지 확인 필요

### 1. 회원가입 (테스트 계정 생성)
POST http://localhost:8080/api/knowledgeout/members/signup
Content-Type: application/json

{
  "email": "test@update.com",
  "password": "password1234",
  "nickname": "테스트t"
}

### 2. 로그인 (세션 쿠키 생성)
# 로그인 성공 시, 서버가 JSESSIONID 쿠키를 응답 헤더로 보냅니다.
# IntelliJ HTTP Client는 이 쿠키를 자동으로 저장합니다.
POST http://localhost:8080/api/knowledgeout/members/login
Content-Type: application/json

{"email": "test@update.com",
  "password": "password1234"
}

### 3. 질문 등록 (쿠키 자동 전송)
# 로그인 후 이 요청을 실행하면 저장된 JSESSIONID 쿠키가 자동으로 헤더에 포함됩니다.
# memberId는 서버가 세션에서 찾으므로 body에서 제외합니다.
POST http://localhost:8080/api/knowledgeout/questions
Content-Type: application/json

{
  "categoryId": 1,
  "title": "세션 인증 테스트 질문입니다.",
  "content": "로그인 후 질문이 잘 등록되는지 확인합니다.",
  "tagNames": ["Session", "Test", "SpringSecurity"]
}

### 4. 질문 목록 조회 (잘 등록되었는지 확인)
GET http://localhost:8080/api/knowledgeout/questions?page=0&size=10


### ============ 질문 수정 테스트 ==============

### 수정 전 상세 조회 테스트
GET http://localhost:8080/api/knowledgeout/questions/1
# Accept 헤더가 application/json으로 정확히 되어 있는지 확인
Accept: application/json

### 1. 로그인 (세션 쿠키 발급)
# 실제 프로젝트의 로그인 엔드포인트와 필드명을 확인하세요.
POST http://localhost:8080/api/knowledgeout/members/login
Content-Type: application/json

{
  "email": "test@test",
  "password": "password1234"
}

> {%
    client.test("세션 쿠키 추출", function() {
        client.assert(response.status === 200, "로그인 실패");

        // Set-Cookie 헤더 전체를 가져와 전역 변수에 저장
        var cookie = response.headers.valueOf("Set-Cookie");
        if (cookie) {
            client.global.set("session_cookie", cookie);
            client.log("성공: session_cookie 변수가 설정되었습니다 -> " + cookie);
        } else {
            client.log("실패: 응답 헤더에 Set-Cookie가 없습니다.");
        }
    });
%}

### 2. 질문 수정 실행 (PUT)
# @AuthenticationPrincipal User user를 식별하기 위해 Cookie 헤더를 포함합니다.
PUT http://localhost:8080/api/knowledgeout/questions/1
Content-Type: application/json
Cookie: {{session_cookie}}

{
  "categoryId": 1,
  "title": "쿠키 수정 TEST",
  "content": "viewCount 8이었고, cookie는 Session, Spring, JPA 였음",
  "tagNames": ["Spring", "JPA", "NewCookie"]
}

> {%
    client.test("세션 기반 수정 완료", function() {
        client.assert(response.status === 200, "성태 코드가 200이어야 합니다.");
    });
%}